services:
  jarvis-agent:
    build: .
    restart: unless-stopped
    mem_limit: 2g
    volumes:
      # Mount data directory (signal-cli registration, sessions, etc.)
      - ./data:/home/jarvis/data
      # Mount Claude config from host for session persistence
      - ~/.claude:/home/jarvis/.claude
      # Persistent workspace for agent files
      - jarvis-workspace:/home/jarvis/workspace
      # Dev mounts: pick up code changes without rebuilding image
      - ./dist:/home/jarvis/dist
      - ./prompts:/home/jarvis/prompts
      - ./scripts:/home/jarvis/scripts
    environment:
      # See specs/1-agent-foundation.md for full environment variable documentation
      - ANTHROPIC_API_KEY
      - ANTHROPIC_MODEL
      - AGENT_NAME
      - AGENT_PHONE_NUMBER
      # MCP server credentials (optional, used by data/mcp.json)
      - IMGFLIP_USERNAME
      - IMGFLIP_PASSWORD
      - TWITTER_API_KEY
      - TWITTER_API_SECRET
      - TWITTER_ACCESS_TOKEN
      - TWITTER_ACCESS_SECRET

volumes:
  jarvis-workspace:
